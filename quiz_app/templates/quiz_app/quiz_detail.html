{% extends 'quiz_app/base.html' %}
{% block content %}
<h2>{{ quiz.title }}</h2>
<form method="post">
    {% csrf_token %}
    <div class="progress mb-4" style="height: 1.2rem;">
        <div class="progress-bar bg-primary" role="progressbar" style="width: 0%; transition: width 0.7s;" id="quiz-progress"></div>
    </div>
    {% for question in questions %}
        <div class="mb-3 question-card" style="opacity:0;">
            <strong>{{ forloop.counter }}. {{ question.text }}</strong>
            {% for choice in question.choices.all %}
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question_{{ question.id }}" value="{{ choice.id }}" id="choice{{ choice.id }}">
                    <label class="form-check-label" for="choice{{ choice.id }}">
                        {{ choice.text }}
                    </label>
                </div>
            {% endfor %}
        </div>
    {% endfor %}
    <button type="submit" class="btn btn-primary">Submit</button>
</form>
<script>
const totalQuestions = Number('{{ questions|length }}');
if (isNaN(totalQuestions)) { totalQuestions = 1; }
function updateProgress() {
    let checked = document.querySelectorAll('.form-check-input:checked').length;
    let percent = Math.round((checked / totalQuestions) * 100);
    document.getElementById('quiz-progress').style.width = percent + '%';
}
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.form-check-input').forEach(input => {
        input.addEventListener('change', updateProgress);
    });
    updateProgress();
});
</script>
{% endblock %}