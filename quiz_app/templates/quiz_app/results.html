{% extends 'quiz_app/base.html' %}
{% block content %}
<h2>Results for {{ quiz.title }}</h2>
<p>Your score: <span id="score-reveal">0 / {{ quiz.questions.count }}</span></p>
<table class="table">
    <thead>
        <tr>
            <th>Question</th>
            <th>Your Answer</th>
            <th>Correct Answer</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
        {% for answer in answers %}
            <tr>
                <td>{{ answer.question.text }}</td>
                <td>{{ answer.selected_choice.text }}</td>
                <td>
                    {% for choice in answer.question.choices.all %}
                        {% if choice.is_correct %}
                            {{ choice.text }}
                        {% endif %}
                    {% endfor %}
                </td>
                <td>
                    {% if answer.correct %}
                        <span class="text-success">Correct</span>
                    {% else %}
                        <span class="text-danger">Incorrect</span>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>
<a href="{% url 'quiz_list' %}" class="btn btn-secondary">Back to Quizzes</a>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var finalScore = Number('{{ submission.score }}');
    var maxScore = Number('{{ quiz.questions.count }}');
    animateScore(finalScore, maxScore, 'score-reveal');
    if (finalScore === maxScore && maxScore > 0) {
        setTimeout(fireConfetti, 800);
    }
});
</script>
{% endblock %}